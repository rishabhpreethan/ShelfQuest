"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/metadata/route";
exports.ids = ["app/api/metadata/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmetadata%2Froute&page=%2Fapi%2Fmetadata%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmetadata%2Froute.ts&appDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmetadata%2Froute&page=%2Fapi%2Fmetadata%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmetadata%2Froute.ts&appDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_rishabh_Documents_personal_bookscout_src_app_api_metadata_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/metadata/route.ts */ \"(rsc)/./src/app/api/metadata/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/metadata/route\",\n        pathname: \"/api/metadata\",\n        filename: \"route\",\n        bundlePath: \"app/api/metadata/route\"\n    },\n    resolvedPagePath: \"/Users/rishabh/Documents/personal/bookscout/src/app/api/metadata/route.ts\",\n    nextConfigOutput,\n    userland: _Users_rishabh_Documents_personal_bookscout_src_app_api_metadata_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/metadata/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZtZXRhZGF0YSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGbWV0YWRhdGElMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZtZXRhZGF0YSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnJpc2hhYmglMkZEb2N1bWVudHMlMkZwZXJzb25hbCUyRmJvb2tzY291dCUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZyaXNoYWJoJTJGRG9jdW1lbnRzJTJGcGVyc29uYWwlMkZib29rc2NvdXQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3lCO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYm9va3Njb3V0Lz9jMzJkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9yaXNoYWJoL0RvY3VtZW50cy9wZXJzb25hbC9ib29rc2NvdXQvc3JjL2FwcC9hcGkvbWV0YWRhdGEvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL21ldGFkYXRhL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvbWV0YWRhdGFcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL21ldGFkYXRhL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL3Jpc2hhYmgvRG9jdW1lbnRzL3BlcnNvbmFsL2Jvb2tzY291dC9zcmMvYXBwL2FwaS9tZXRhZGF0YS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvbWV0YWRhdGEvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmetadata%2Froute&page=%2Fapi%2Fmetadata%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmetadata%2Froute.ts&appDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/metadata/route.ts":
/*!***************************************!*\
  !*** ./src/app/api/metadata/route.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_googleBooks__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/googleBooks */ \"(rsc)/./src/lib/googleBooks.ts\");\n/* harmony import */ var _lib_openLibrary__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/openLibrary */ \"(rsc)/./src/lib/openLibrary.ts\");\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./src/lib/config.ts\");\n/* harmony import */ var _lib_gemini__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/gemini */ \"(rsc)/./src/lib/gemini.ts\");\n\n\n\n\n\nconst RATE_LIMIT_WINDOW_MS = 60000;\nconst RATE_LIMIT_MAX = 20;\nconst requests = new Map();\nfunction rateLimit(ip) {\n    const now = Date.now();\n    const arr = (requests.get(ip) || []).filter((t)=>now - t < RATE_LIMIT_WINDOW_MS);\n    arr.push(now);\n    requests.set(ip, arr);\n    return arr.length <= RATE_LIMIT_MAX;\n}\nasync function POST(req) {\n    const ip = (req.headers.get(\"x-forwarded-for\") || req.headers.get(\"x-real-ip\") || \"local\").split(\",\")[0].trim();\n    if (!rateLimit(ip)) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        error: \"Rate limit exceeded\"\n    }, {\n        status: 429\n    });\n    try {\n        const body = await req.json().catch(()=>({}));\n        const titles = Array.isArray(body.titles) ? body.titles.slice(0, 30) : [];\n        if (!titles.length) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            books: []\n        });\n        const results = [];\n        for (const title of titles){\n            let meta = await (0,_lib_googleBooks__WEBPACK_IMPORTED_MODULE_1__.searchGoogleBooksByTitle)(title);\n            if (!meta) meta = await (0,_lib_openLibrary__WEBPACK_IMPORTED_MODULE_2__.searchOpenLibraryByTitle)(title);\n            if (meta) results.push(meta);\n        }\n        // Optional: fill missing summary/rating with Gemini (budget-friendly: combine few at a time)\n        if (_lib_config__WEBPACK_IMPORTED_MODULE_3__.GEMINI_API_KEY) {\n            try {\n                const missing = results.filter((b)=>!b.summary).slice(0, 10) // cap\n                ;\n                if (missing.length) {\n                    const model = (0,_lib_gemini__WEBPACK_IMPORTED_MODULE_4__.textModel)();\n                    const prompt = `Provide a 2-sentence, spoiler-light blurb for each book. Return JSON array with {id, summary}.\\nBooks: ${JSON.stringify(missing.map((m)=>({\n                            id: m.id,\n                            title: m.title,\n                            authors: m.authors\n                        })))} `;\n                    const r = await model.generateContent([\n                        {\n                            text: prompt\n                        }\n                    ]);\n                    const txt = r.response.text();\n                    const start = txt.indexOf(\"[\");\n                    if (start >= 0) {\n                        const arr = JSON.parse(txt.slice(start));\n                        const byId = new Map(arr.map((x)=>[\n                                x.id,\n                                x.summary\n                            ]));\n                        for (const b of results){\n                            if (!b.summary && byId.has(b.id)) b.summary = byId.get(b.id);\n                        }\n                    }\n                }\n            } catch (e) {\n            // ignore fill errors\n            }\n        }\n        // De-dupe by normalized title+authors\n        const seen = new Set();\n        const deduped = [];\n        for (const b of results){\n            const key = `${b.title?.toLowerCase() || \"\"}|${(b.authors || []).join(\",\").toLowerCase()}`;\n            if (key.trim() && !seen.has(key)) {\n                seen.add(key);\n                deduped.push(b);\n            }\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            books: deduped\n        });\n    } catch (e) {\n        console.error(\"metadata error\", e);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to fetch book metadata\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNuRCxLQUFLLE1BQU1ELEtBQUtKLFFBQVM7NEJBQ3ZCLElBQUksQ0FBQ0ksRUFBRUMsT0FBTyxJQUFJaUIsS0FBS0UsR0FBRyxDQUFDcEIsRUFBRVEsRUFBRSxHQUFHUixFQUFFQyxPQUFPLEdBQUdpQixLQUFLM0MsR0FBRyxDQUFDeUIsRUFBRVEsRUFBRTt3QkFDN0Q7b0JBQ0Y7Z0JBQ0Y7WUFDRixFQUFFLE9BQU9hLEdBQUc7WUFDVixxQkFBcUI7WUFDdkI7UUFDRjtRQUVBLHNDQUFzQztRQUN0QyxNQUFNQyxPQUFPLElBQUlDO1FBQ2pCLE1BQU1DLFVBQTBCLEVBQUU7UUFDbEMsS0FBSyxNQUFNeEIsS0FBS0osUUFBUztZQUN2QixNQUFNNkIsTUFBTSxDQUFDLEVBQUV6QixFQUFFSCxLQUFLLEVBQUU2QixpQkFBaUIsR0FBRyxDQUFDLEVBQUUsQ0FBQzFCLEVBQUVTLE9BQU8sSUFBRSxFQUFFLEVBQUVrQixJQUFJLENBQUMsS0FBS0QsV0FBVyxHQUFHLENBQUM7WUFDeEYsSUFBSUQsSUFBSXhDLElBQUksTUFBTSxDQUFDcUMsS0FBS0YsR0FBRyxDQUFDSyxNQUFNO2dCQUFFSCxLQUFLTSxHQUFHLENBQUNIO2dCQUFNRCxRQUFROUMsSUFBSSxDQUFDc0I7WUFBRztRQUNyRTtRQUVBLE9BQU92QyxxREFBWUEsQ0FBQ3lCLElBQUksQ0FBQztZQUFFUyxPQUFPNkI7UUFBUTtJQUM1QyxFQUFFLE9BQU9ILEdBQUc7UUFDVlEsUUFBUTFDLEtBQUssQ0FBQyxrQkFBa0JrQztRQUNoQyxPQUFPNUQscURBQVlBLENBQUN5QixJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFnQyxHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUNyRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYm9va3Njb3V0Ly4vc3JjL2FwcC9hcGkvbWV0YWRhdGEvcm91dGUudHM/NjBkYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IHNlYXJjaEdvb2dsZUJvb2tzQnlUaXRsZSB9IGZyb20gJ0AvbGliL2dvb2dsZUJvb2tzJ1xuaW1wb3J0IHsgc2VhcmNoT3BlbkxpYnJhcnlCeVRpdGxlIH0gZnJvbSAnQC9saWIvb3BlbkxpYnJhcnknXG5pbXBvcnQgeyBCb29rTWV0YWRhdGEgfSBmcm9tICdAL2xpYi90eXBlcydcbmltcG9ydCB7IEdFTUlOSV9BUElfS0VZIH0gZnJvbSAnQC9saWIvY29uZmlnJ1xuaW1wb3J0IHsgc3VtbWFyaXplQW5kUmVhc29uLCB0ZXh0TW9kZWwgfSBmcm9tICdAL2xpYi9nZW1pbmknXG5cbmNvbnN0IFJBVEVfTElNSVRfV0lORE9XX01TID0gNjBfMDAwXG5jb25zdCBSQVRFX0xJTUlUX01BWCA9IDIwXG5jb25zdCByZXF1ZXN0cyA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXJbXT4oKVxuXG5mdW5jdGlvbiByYXRlTGltaXQoaXA6IHN0cmluZykge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpXG4gIGNvbnN0IGFyciA9IChyZXF1ZXN0cy5nZXQoaXApIHx8IFtdKS5maWx0ZXIodCA9PiBub3cgLSB0IDwgUkFURV9MSU1JVF9XSU5ET1dfTVMpXG4gIGFyci5wdXNoKG5vdylcbiAgcmVxdWVzdHMuc2V0KGlwLCBhcnIpXG4gIHJldHVybiBhcnIubGVuZ3RoIDw9IFJBVEVfTElNSVRfTUFYXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogUmVxdWVzdCkge1xuICBjb25zdCBpcCA9IChyZXEuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8IHJlcS5oZWFkZXJzLmdldCgneC1yZWFsLWlwJykgfHwgJ2xvY2FsJykuc3BsaXQoJywnKVswXS50cmltKClcbiAgaWYgKCFyYXRlTGltaXQoaXApKSByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1JhdGUgbGltaXQgZXhjZWVkZWQnIH0sIHsgc3RhdHVzOiA0MjkgfSlcblxuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXEuanNvbigpLmNhdGNoKCgpID0+ICh7fSkpXG4gICAgY29uc3QgdGl0bGVzOiBzdHJpbmdbXSA9IEFycmF5LmlzQXJyYXkoYm9keS50aXRsZXMpID8gYm9keS50aXRsZXMuc2xpY2UoMCwgMzApIDogW11cbiAgICBpZiAoIXRpdGxlcy5sZW5ndGgpIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGJvb2tzOiBbXSB9KVxuXG4gICAgY29uc3QgcmVzdWx0czogQm9va01ldGFkYXRhW10gPSBbXVxuXG4gICAgZm9yIChjb25zdCB0aXRsZSBvZiB0aXRsZXMpIHtcbiAgICAgIGxldCBtZXRhID0gYXdhaXQgc2VhcmNoR29vZ2xlQm9va3NCeVRpdGxlKHRpdGxlKVxuICAgICAgaWYgKCFtZXRhKSBtZXRhID0gYXdhaXQgc2VhcmNoT3BlbkxpYnJhcnlCeVRpdGxlKHRpdGxlKVxuICAgICAgaWYgKG1ldGEpIHJlc3VsdHMucHVzaChtZXRhKVxuICAgIH1cblxuICAgIC8vIE9wdGlvbmFsOiBmaWxsIG1pc3Npbmcgc3VtbWFyeS9yYXRpbmcgd2l0aCBHZW1pbmkgKGJ1ZGdldC1mcmllbmRseTogY29tYmluZSBmZXcgYXQgYSB0aW1lKVxuICAgIGlmIChHRU1JTklfQVBJX0tFWSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbWlzc2luZyA9IHJlc3VsdHMuZmlsdGVyKGIgPT4gIWIuc3VtbWFyeSkuc2xpY2UoMCwgMTApIC8vIGNhcFxuICAgICAgICBpZiAobWlzc2luZy5sZW5ndGgpIHtcbiAgICAgICAgICBjb25zdCBtb2RlbCA9IHRleHRNb2RlbCgpXG4gICAgICAgICAgY29uc3QgcHJvbXB0ID0gYFByb3ZpZGUgYSAyLXNlbnRlbmNlLCBzcG9pbGVyLWxpZ2h0IGJsdXJiIGZvciBlYWNoIGJvb2suIFJldHVybiBKU09OIGFycmF5IHdpdGgge2lkLCBzdW1tYXJ5fS5cXG5Cb29rczogJHtKU09OLnN0cmluZ2lmeShtaXNzaW5nLm1hcChtID0+ICh7IGlkOiBtLmlkLCB0aXRsZTogbS50aXRsZSwgYXV0aG9yczogbS5hdXRob3JzIH0pKSl9IGBcbiAgICAgICAgICBjb25zdCByID0gYXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KFt7IHRleHQ6IHByb21wdCB9XSlcbiAgICAgICAgICBjb25zdCB0eHQgPSByLnJlc3BvbnNlLnRleHQoKVxuICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gdHh0LmluZGV4T2YoJ1snKVxuICAgICAgICAgIGlmIChzdGFydCA+PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBhcnIgPSBKU09OLnBhcnNlKHR4dC5zbGljZShzdGFydCkpIGFzIHsgaWQ6IHN0cmluZywgc3VtbWFyeTogc3RyaW5nIH1bXVxuICAgICAgICAgICAgY29uc3QgYnlJZCA9IG5ldyBNYXAoYXJyLm1hcCh4ID0+IFt4LmlkLCB4LnN1bW1hcnldKSlcbiAgICAgICAgICAgIGZvciAoY29uc3QgYiBvZiByZXN1bHRzKSB7XG4gICAgICAgICAgICAgIGlmICghYi5zdW1tYXJ5ICYmIGJ5SWQuaGFzKGIuaWQpKSBiLnN1bW1hcnkgPSBieUlkLmdldChiLmlkKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBpZ25vcmUgZmlsbCBlcnJvcnNcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBEZS1kdXBlIGJ5IG5vcm1hbGl6ZWQgdGl0bGUrYXV0aG9yc1xuICAgIGNvbnN0IHNlZW4gPSBuZXcgU2V0PHN0cmluZz4oKVxuICAgIGNvbnN0IGRlZHVwZWQ6IEJvb2tNZXRhZGF0YVtdID0gW11cbiAgICBmb3IgKGNvbnN0IGIgb2YgcmVzdWx0cykge1xuICAgICAgY29uc3Qga2V5ID0gYCR7Yi50aXRsZT8udG9Mb3dlckNhc2UoKSB8fCAnJ318JHsoYi5hdXRob3JzfHxbXSkuam9pbignLCcpLnRvTG93ZXJDYXNlKCl9YFxuICAgICAgaWYgKGtleS50cmltKCkgJiYgIXNlZW4uaGFzKGtleSkpIHsgc2Vlbi5hZGQoa2V5KTsgZGVkdXBlZC5wdXNoKGIpIH1cbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBib29rczogZGVkdXBlZCB9KVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcignbWV0YWRhdGEgZXJyb3InLCBlKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIGJvb2sgbWV0YWRhdGEnIH0sIHsgc3RhdHVzOiA1MDAgfSlcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInNlYXJjaEdvb2dsZUJvb2tzQnlUaXRsZSIsInNlYXJjaE9wZW5MaWJyYXJ5QnlUaXRsZSIsIkdFTUlOSV9BUElfS0VZIiwidGV4dE1vZGVsIiwiUkFURV9MSU1JVF9XSU5ET1dfTVMiLCJSQVRFX0xJTUlUX01BWCIsInJlcXVlc3RzIiwiTWFwIiwicmF0ZUxpbWl0IiwiaXAiLCJub3ciLCJEYXRlIiwiYXJyIiwiZ2V0IiwiZmlsdGVyIiwidCIsInB1c2giLCJzZXQiLCJsZW5ndGgiLCJQT1NUIiwicmVxIiwiaGVhZGVycyIsInNwbGl0IiwidHJpbSIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsImJvZHkiLCJjYXRjaCIsInRpdGxlcyIsIkFycmF5IiwiaXNBcnJheSIsInNsaWNlIiwiYm9va3MiLCJyZXN1bHRzIiwidGl0bGUiLCJtZXRhIiwibWlzc2luZyIsImIiLCJzdW1tYXJ5IiwibW9kZWwiLCJwcm9tcHQiLCJKU09OIiwic3RyaW5naWZ5IiwibWFwIiwibSIsImlkIiwiYXV0aG9ycyIsInIiLCJnZW5lcmF0ZUNvbnRlbnQiLCJ0ZXh0IiwidHh0IiwicmVzcG9uc2UiLCJzdGFydCIsImluZGV4T2YiLCJwYXJzZSIsImJ5SWQiLCJ4IiwiaGFzIiwiZSIsInNlZW4iLCJTZXQiLCJkZWR1cGVkIiwia2V5IiwidG9Mb3dlckNhc2UiLCJqb2luIiwiYWRkIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/metadata/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/config.ts":
/*!***************************!*\
  !*** ./src/lib/config.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AMAZON_AFFILIATE_TAG: () => (/* binding */ AMAZON_AFFILIATE_TAG),\n/* harmony export */   GEMINI_API_KEY: () => (/* binding */ GEMINI_API_KEY),\n/* harmony export */   GOOGLE_BOOKS_API_KEY: () => (/* binding */ GOOGLE_BOOKS_API_KEY)\n/* harmony export */ });\nconst GEMINI_API_KEY = process.env.GEMINI_API_KEY || \"\";\nconst GOOGLE_BOOKS_API_KEY = process.env.GOOGLE_BOOKS_API_KEY || \"\";\nconst AMAZON_AFFILIATE_TAG = process.env.AMAZON_AFFILIATE_TAG || \"\";\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NvbmZpZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBTyxNQUFNQSxpQkFBaUJDLFFBQVFDLEdBQUcsQ0FBQ0YsY0FBYyxJQUFJLEdBQUU7QUFDdkQsTUFBTUcsdUJBQXVCRixRQUFRQyxHQUFHLENBQUNDLG9CQUFvQixJQUFJLEdBQUU7QUFDbkUsTUFBTUMsdUJBQXVCSCxRQUFRQyxHQUFHLENBQUNFLG9CQUFvQixJQUFJLEdBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ib29rc2NvdXQvLi9zcmMvbGliL2NvbmZpZy50cz9hM2VmIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBHRU1JTklfQVBJX0tFWSA9IHByb2Nlc3MuZW52LkdFTUlOSV9BUElfS0VZIHx8ICcnXG5leHBvcnQgY29uc3QgR09PR0xFX0JPT0tTX0FQSV9LRVkgPSBwcm9jZXNzLmVudi5HT09HTEVfQk9PS1NfQVBJX0tFWSB8fCAnJ1xuZXhwb3J0IGNvbnN0IEFNQVpPTl9BRkZJTElBVEVfVEFHID0gcHJvY2Vzcy5lbnYuQU1BWk9OX0FGRklMSUFURV9UQUcgfHwgJydcbiJdLCJuYW1lcyI6WyJHRU1JTklfQVBJX0tFWSIsInByb2Nlc3MiLCJlbnYiLCJHT09HTEVfQk9PS1NfQVBJX0tFWSIsIkFNQVpPTl9BRkZJTElBVEVfVEFHIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/config.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/gemini.ts":
/*!***************************!*\
  !*** ./src/lib/gemini.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   genAI: () => (/* binding */ genAI),\n/* harmony export */   ocrFromImage: () => (/* binding */ ocrFromImage),\n/* harmony export */   summarizeAndReason: () => (/* binding */ summarizeAndReason),\n/* harmony export */   textModel: () => (/* binding */ textModel)\n/* harmony export */ });\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./config */ \"(rsc)/./src/lib/config.ts\");\n\n\nif (!_config__WEBPACK_IMPORTED_MODULE_1__.GEMINI_API_KEY) {\n// Let routes handle the error gracefully; no throw here to allow app to boot\n}\nconst genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__.GoogleGenerativeAI(_config__WEBPACK_IMPORTED_MODULE_1__.GEMINI_API_KEY);\nfunction textModel() {\n    return genAI.getGenerativeModel({\n        model: \"gemini-1.5-flash\"\n    });\n}\nfunction stripCodeFences(s) {\n    // Remove ```json ... ``` or ``` ... ``` fences\n    const fenced = s.match(/```(?:json)?\\n([\\s\\S]*?)```/i);\n    if (fenced && fenced[1]) return fenced[1].trim();\n    return s.trim();\n}\nfunction extractJSONObject(text) {\n    const cleaned = stripCodeFences(text);\n    // Try to find the first '{' and the matching last '}'\n    const first = cleaned.indexOf(\"{\");\n    const last = cleaned.lastIndexOf(\"}\");\n    if (first !== -1 && last !== -1 && last > first) {\n        const candidate = cleaned.slice(first, last + 1);\n        try {\n            return JSON.parse(candidate);\n        } catch  {}\n    }\n    // Fallback: try to eval a safer JSON by removing trailing commas\n    try {\n        const relaxed = cleaned.replace(/,\\s*([}\\]])/g, \"$1\") // remove trailing commas\n        ;\n        const f = relaxed.indexOf(\"{\");\n        const l = relaxed.lastIndexOf(\"}\");\n        if (f !== -1 && l !== -1 && l > f) {\n            return JSON.parse(relaxed.slice(f, l + 1));\n        }\n    } catch  {}\n    throw new Error(\"Failed to parse JSON from model output\");\n}\nasync function ocrFromImage(bytes, mimeType) {\n    const model = textModel();\n    const prompt = `You are an OCR assistant for bookshelf photos. Extract plausible book titles and optional authors.\n  Return only JSON with shape: {\"titles\": string[], \"authors\": string[]}. Titles should be deduplicated, trimmed.`;\n    const res = await model.generateContent([\n        {\n            text: prompt\n        },\n        {\n            inlineData: {\n                data: Buffer.from(bytes).toString(\"base64\"),\n                mimeType\n            }\n        }\n    ]);\n    const out = res.response.text();\n    try {\n        const json = extractJSONObject(out);\n        return {\n            titles: Array.from(new Set((json.titles || []).map((s)=>s.trim()))),\n            authors: Array.from(new Set((json.authors || []).map((s)=>s.trim())))\n        };\n    } catch  {\n        // naive fallback: extract Capitalized phrases\n        const text = out.replace(/\\n/g, \" \");\n        const matches = text.match(/([A-Z][A-Za-z0-9'’:&-]+(?:\\s+[A-Z][A-Za-z0-9'’:&-]+){0,6})/g) || [];\n        const titles = Array.from(new Set(matches.map((s)=>s.trim()).filter((s)=>s.split(\" \").length >= 2))).slice(0, 50);\n        return {\n            titles,\n            authors: []\n        };\n    }\n}\nasync function summarizeAndReason(payload) {\n    const model = textModel();\n    const prompt = `Given extracted shelf titles, user preferences, and matched book metadata, produce:\n- summary: 3-6 bullet points concise.\n- reasons: a mapping from book id to a one-sentence reason (<=25 words) why it matches.\nKeep it helpful and specific. Return only JSON {\"summary\": string, \"reasons\": Record<string,string>}.`;\n    const res = await model.generateContent([\n        {\n            text: prompt + \"\\n\\nDATA:\\n\" + JSON.stringify(payload)\n        }\n    ]);\n    const out = res.response.text();\n    try {\n        return extractJSONObject(out);\n    } catch  {\n        return {\n            summary: \"AI unavailable. Showing matched titles from metadata only.\",\n            reasons: {}\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUV5QyxLQUFLLENBQUMsS0FBS0MsTUFBTSxJQUFFLEtBQUs5QixLQUFLLENBQUMsR0FBRTtRQUN2RyxPQUFPO1lBQUVzQjtZQUFRSSxTQUFTLEVBQUU7UUFBYTtJQUMzQztBQUNGO0FBRU8sZUFBZUssbUJBQW1CQyxPQUFZO0lBQ25ELE1BQU05QyxRQUFRRjtJQUNkLE1BQU0yQixTQUFTLENBQUM7OztxR0FHbUYsQ0FBQztJQUNwRyxNQUFNQyxNQUFNLE1BQU0xQixNQUFNMkIsZUFBZSxDQUFDO1FBQUM7WUFBRXBCLE1BQU1rQixTQUFTLGdCQUFnQlYsS0FBS2dDLFNBQVMsQ0FBQ0Q7UUFBUztLQUFFO0lBQ3BHLE1BQU1iLE1BQU1QLElBQUlRLFFBQVEsQ0FBQzNCLElBQUk7SUFDN0IsSUFBSTtRQUNGLE9BQU9ELGtCQUFrQjJCO0lBQzNCLEVBQUUsT0FBTTtRQUNOLE9BQU87WUFBRWUsU0FBUztZQUE4REMsU0FBUyxDQUFDO1FBQUU7SUFDOUY7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Jvb2tzY291dC8uL3NyYy9saWIvZ2VtaW5pLnRzPzk5NGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR29vZ2xlR2VuZXJhdGl2ZUFJIH0gZnJvbSAnQGdvb2dsZS9nZW5lcmF0aXZlLWFpJ1xuaW1wb3J0IHsgR0VNSU5JX0FQSV9LRVkgfSBmcm9tICcuL2NvbmZpZydcblxuaWYgKCFHRU1JTklfQVBJX0tFWSkge1xuICAvLyBMZXQgcm91dGVzIGhhbmRsZSB0aGUgZXJyb3IgZ3JhY2VmdWxseTsgbm8gdGhyb3cgaGVyZSB0byBhbGxvdyBhcHAgdG8gYm9vdFxufVxuXG5leHBvcnQgY29uc3QgZ2VuQUkgPSBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJKEdFTUlOSV9BUElfS0VZKVxuXG5leHBvcnQgZnVuY3Rpb24gdGV4dE1vZGVsKCkge1xuICByZXR1cm4gZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgbW9kZWw6ICdnZW1pbmktMS41LWZsYXNoJyB9KVxufVxuXG5mdW5jdGlvbiBzdHJpcENvZGVGZW5jZXMoczogc3RyaW5nKSB7XG4gIC8vIFJlbW92ZSBgYGBqc29uIC4uLiBgYGAgb3IgYGBgIC4uLiBgYGAgZmVuY2VzXG4gIGNvbnN0IGZlbmNlZCA9IHMubWF0Y2goL2BgYCg/Ompzb24pP1xcbihbXFxzXFxTXSo/KWBgYC9pKVxuICBpZiAoZmVuY2VkICYmIGZlbmNlZFsxXSkgcmV0dXJuIGZlbmNlZFsxXS50cmltKClcbiAgcmV0dXJuIHMudHJpbSgpXG59XG5cbmZ1bmN0aW9uIGV4dHJhY3RKU09OT2JqZWN0KHRleHQ6IHN0cmluZyk6IGFueSB7XG4gIGNvbnN0IGNsZWFuZWQgPSBzdHJpcENvZGVGZW5jZXModGV4dClcbiAgLy8gVHJ5IHRvIGZpbmQgdGhlIGZpcnN0ICd7JyBhbmQgdGhlIG1hdGNoaW5nIGxhc3QgJ30nXG4gIGNvbnN0IGZpcnN0ID0gY2xlYW5lZC5pbmRleE9mKCd7JylcbiAgY29uc3QgbGFzdCA9IGNsZWFuZWQubGFzdEluZGV4T2YoJ30nKVxuICBpZiAoZmlyc3QgIT09IC0xICYmIGxhc3QgIT09IC0xICYmIGxhc3QgPiBmaXJzdCkge1xuICAgIGNvbnN0IGNhbmRpZGF0ZSA9IGNsZWFuZWQuc2xpY2UoZmlyc3QsIGxhc3QgKyAxKVxuICAgIHRyeSB7IHJldHVybiBKU09OLnBhcnNlKGNhbmRpZGF0ZSkgfSBjYXRjaCB7fVxuICB9XG4gIC8vIEZhbGxiYWNrOiB0cnkgdG8gZXZhbCBhIHNhZmVyIEpTT04gYnkgcmVtb3ZpbmcgdHJhaWxpbmcgY29tbWFzXG4gIHRyeSB7XG4gICAgY29uc3QgcmVsYXhlZCA9IGNsZWFuZWRcbiAgICAgIC5yZXBsYWNlKC8sXFxzKihbfVxcXV0pL2csICckMScpIC8vIHJlbW92ZSB0cmFpbGluZyBjb21tYXNcbiAgICBjb25zdCBmID0gcmVsYXhlZC5pbmRleE9mKCd7JylcbiAgICBjb25zdCBsID0gcmVsYXhlZC5sYXN0SW5kZXhPZignfScpXG4gICAgaWYgKGYgIT09IC0xICYmIGwgIT09IC0xICYmIGwgPiBmKSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShyZWxheGVkLnNsaWNlKGYsIGwgKyAxKSlcbiAgICB9XG4gIH0gY2F0Y2gge31cbiAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gcGFyc2UgSlNPTiBmcm9tIG1vZGVsIG91dHB1dCcpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvY3JGcm9tSW1hZ2UoYnl0ZXM6IFVpbnQ4QXJyYXksIG1pbWVUeXBlOiBzdHJpbmcpIHtcbiAgY29uc3QgbW9kZWwgPSB0ZXh0TW9kZWwoKVxuICBjb25zdCBwcm9tcHQgPSBgWW91IGFyZSBhbiBPQ1IgYXNzaXN0YW50IGZvciBib29rc2hlbGYgcGhvdG9zLiBFeHRyYWN0IHBsYXVzaWJsZSBib29rIHRpdGxlcyBhbmQgb3B0aW9uYWwgYXV0aG9ycy5cbiAgUmV0dXJuIG9ubHkgSlNPTiB3aXRoIHNoYXBlOiB7XCJ0aXRsZXNcIjogc3RyaW5nW10sIFwiYXV0aG9yc1wiOiBzdHJpbmdbXX0uIFRpdGxlcyBzaG91bGQgYmUgZGVkdXBsaWNhdGVkLCB0cmltbWVkLmBcbiAgY29uc3QgcmVzID0gYXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KFtcbiAgICB7IHRleHQ6IHByb21wdCB9LFxuICAgIHsgaW5saW5lRGF0YTogeyBkYXRhOiBCdWZmZXIuZnJvbShieXRlcykudG9TdHJpbmcoJ2Jhc2U2NCcpLCBtaW1lVHlwZSB9IGFzIGFueSB9LFxuICBdKVxuICBjb25zdCBvdXQgPSByZXMucmVzcG9uc2UudGV4dCgpXG4gIHRyeSB7XG4gICAgY29uc3QganNvbiA9IGV4dHJhY3RKU09OT2JqZWN0KG91dClcbiAgICByZXR1cm4geyB0aXRsZXM6IEFycmF5LmZyb20obmV3IFNldCgoanNvbi50aXRsZXN8fFtdKS5tYXAoKHM6c3RyaW5nKT0+cy50cmltKCkpKSksIGF1dGhvcnM6IEFycmF5LmZyb20obmV3IFNldCgoanNvbi5hdXRob3JzfHxbXSkubWFwKChzOnN0cmluZyk9PnMudHJpbSgpKSkpIH1cbiAgfSBjYXRjaCB7XG4gICAgLy8gbmFpdmUgZmFsbGJhY2s6IGV4dHJhY3QgQ2FwaXRhbGl6ZWQgcGhyYXNlc1xuICAgIGNvbnN0IHRleHQgPSBvdXQucmVwbGFjZSgvXFxuL2csICcgJylcbiAgICBjb25zdCBtYXRjaGVzID0gdGV4dC5tYXRjaCgvKFtBLVpdW0EtWmEtejAtOSfigJk6Ji1dKyg/OlxccytbQS1aXVtBLVphLXowLTkn4oCZOiYtXSspezAsNn0pL2cpIHx8IFtdXG4gICAgY29uc3QgdGl0bGVzID0gQXJyYXkuZnJvbShuZXcgU2V0KG1hdGNoZXMubWFwKHM9PnMudHJpbSgpKS5maWx0ZXIocz0+cy5zcGxpdCgnICcpLmxlbmd0aD49MikpKS5zbGljZSgwLDUwKVxuICAgIHJldHVybiB7IHRpdGxlcywgYXV0aG9yczogW10gYXMgc3RyaW5nW10gfVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdW1tYXJpemVBbmRSZWFzb24ocGF5bG9hZDogYW55KSB7XG4gIGNvbnN0IG1vZGVsID0gdGV4dE1vZGVsKClcbiAgY29uc3QgcHJvbXB0ID0gYEdpdmVuIGV4dHJhY3RlZCBzaGVsZiB0aXRsZXMsIHVzZXIgcHJlZmVyZW5jZXMsIGFuZCBtYXRjaGVkIGJvb2sgbWV0YWRhdGEsIHByb2R1Y2U6XG4tIHN1bW1hcnk6IDMtNiBidWxsZXQgcG9pbnRzIGNvbmNpc2UuXG4tIHJlYXNvbnM6IGEgbWFwcGluZyBmcm9tIGJvb2sgaWQgdG8gYSBvbmUtc2VudGVuY2UgcmVhc29uICg8PTI1IHdvcmRzKSB3aHkgaXQgbWF0Y2hlcy5cbktlZXAgaXQgaGVscGZ1bCBhbmQgc3BlY2lmaWMuIFJldHVybiBvbmx5IEpTT04ge1wic3VtbWFyeVwiOiBzdHJpbmcsIFwicmVhc29uc1wiOiBSZWNvcmQ8c3RyaW5nLHN0cmluZz59LmBcbiAgY29uc3QgcmVzID0gYXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KFt7IHRleHQ6IHByb21wdCArIFwiXFxuXFxuREFUQTpcXG5cIiArIEpTT04uc3RyaW5naWZ5KHBheWxvYWQpIH1dKVxuICBjb25zdCBvdXQgPSByZXMucmVzcG9uc2UudGV4dCgpXG4gIHRyeSB7XG4gICAgcmV0dXJuIGV4dHJhY3RKU09OT2JqZWN0KG91dClcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIHsgc3VtbWFyeTogJ0FJIHVuYXZhaWxhYmxlLiBTaG93aW5nIG1hdGNoZWQgdGl0bGVzIGZyb20gbWV0YWRhdGEgb25seS4nLCByZWFzb25zOiB7fSB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJHb29nbGVHZW5lcmF0aXZlQUkiLCJHRU1JTklfQVBJX0tFWSIsImdlbkFJIiwidGV4dE1vZGVsIiwiZ2V0R2VuZXJhdGl2ZU1vZGVsIiwibW9kZWwiLCJzdHJpcENvZGVGZW5jZXMiLCJzIiwiZmVuY2VkIiwibWF0Y2giLCJ0cmltIiwiZXh0cmFjdEpTT05PYmplY3QiLCJ0ZXh0IiwiY2xlYW5lZCIsImZpcnN0IiwiaW5kZXhPZiIsImxhc3QiLCJsYXN0SW5kZXhPZiIsImNhbmRpZGF0ZSIsInNsaWNlIiwiSlNPTiIsInBhcnNlIiwicmVsYXhlZCIsInJlcGxhY2UiLCJmIiwibCIsIkVycm9yIiwib2NyRnJvbUltYWdlIiwiYnl0ZXMiLCJtaW1lVHlwZSIsInByb21wdCIsInJlcyIsImdlbmVyYXRlQ29udGVudCIsImlubGluZURhdGEiLCJkYXRhIiwiQnVmZmVyIiwiZnJvbSIsInRvU3RyaW5nIiwib3V0IiwicmVzcG9uc2UiLCJqc29uIiwidGl0bGVzIiwiQXJyYXkiLCJTZXQiLCJtYXAiLCJhdXRob3JzIiwibWF0Y2hlcyIsImZpbHRlciIsInNwbGl0IiwibGVuZ3RoIiwic3VtbWFyaXplQW5kUmVhc29uIiwicGF5bG9hZCIsInN0cmluZ2lmeSIsInN1bW1hcnkiLCJyZWFzb25zIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/gemini.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/googleBooks.ts":
/*!********************************!*\
  !*** ./src/lib/googleBooks.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   searchGoogleBooksByTitle: () => (/* binding */ searchGoogleBooksByTitle)\n/* harmony export */ });\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./config */ \"(rsc)/./src/lib/config.ts\");\n\nasync function searchGoogleBooksByTitle(title) {\n    const q = encodeURIComponent(`intitle:${title}`);\n    const key = _config__WEBPACK_IMPORTED_MODULE_0__.GOOGLE_BOOKS_API_KEY ? `&key=${_config__WEBPACK_IMPORTED_MODULE_0__.GOOGLE_BOOKS_API_KEY}` : \"\";\n    const url = `https://www.googleapis.com/books/v1/volumes?q=${q}${key}&maxResults=1`;\n    const r = await fetch(url);\n    if (!r.ok) return null;\n    const j = await r.json();\n    const item = j.items?.[0];\n    if (!item) return null;\n    const v = item.volumeInfo || {};\n    const isbn13 = (v.industryIdentifiers || []).find((x)=>x.type === \"ISBN_13\")?.identifier;\n    const amazonAffiliate = isbn13 && _config__WEBPACK_IMPORTED_MODULE_0__.AMAZON_AFFILIATE_TAG ? `https://www.amazon.com/dp/${isbn13}/?tag=${_config__WEBPACK_IMPORTED_MODULE_0__.AMAZON_AFFILIATE_TAG}` : undefined;\n    return {\n        id: item.id,\n        title: v.title,\n        authors: v.authors || [],\n        thumbnail: v.imageLinks?.thumbnail?.replace(\"http://\", \"https://\"),\n        infoLink: v.infoLink,\n        previewLink: v.previewLink,\n        isbn13,\n        summary: v.description,\n        amazonAffiliate\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2dvb2dsZUJvb2tzLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQ3FFO0FBRTlELGVBQWVFLHlCQUF5QkMsS0FBYTtJQUMxRCxNQUFNQyxJQUFJQyxtQkFBbUIsQ0FBQyxRQUFRLEVBQUVGLE1BQU0sQ0FBQztJQUMvQyxNQUFNRyxNQUFNTix5REFBb0JBLEdBQUcsQ0FBQyxLQUFLLEVBQUVBLHlEQUFvQkEsQ0FBQyxDQUFDLEdBQUc7SUFDcEUsTUFBTU8sTUFBTSxDQUFDLDhDQUE4QyxFQUFFSCxFQUFFLEVBQUVFLElBQUksYUFBYSxDQUFDO0lBQ25GLE1BQU1FLElBQUksTUFBTUMsTUFBTUY7SUFDdEIsSUFBSSxDQUFDQyxFQUFFRSxFQUFFLEVBQUUsT0FBTztJQUNsQixNQUFNQyxJQUFJLE1BQU1ILEVBQUVJLElBQUk7SUFDdEIsTUFBTUMsT0FBT0YsRUFBRUcsS0FBSyxFQUFFLENBQUMsRUFBRTtJQUN6QixJQUFJLENBQUNELE1BQU0sT0FBTztJQUNsQixNQUFNRSxJQUFJRixLQUFLRyxVQUFVLElBQUksQ0FBQztJQUM5QixNQUFNQyxTQUFTLENBQUNGLEVBQUVHLG1CQUFtQixJQUFJLEVBQUUsRUFBRUMsSUFBSSxDQUFDLENBQUNDLElBQVdBLEVBQUVDLElBQUksS0FBSyxZQUFZQztJQUNyRixNQUFNQyxrQkFBa0JOLFVBQVVoQix5REFBb0JBLEdBQUcsQ0FBQywwQkFBMEIsRUFBRWdCLE9BQU8sTUFBTSxFQUFFaEIseURBQW9CQSxDQUFDLENBQUMsR0FBR3VCO0lBQzlILE9BQU87UUFDTEMsSUFBSVosS0FBS1ksRUFBRTtRQUNYdEIsT0FBT1ksRUFBRVosS0FBSztRQUNkdUIsU0FBU1gsRUFBRVcsT0FBTyxJQUFJLEVBQUU7UUFDeEJDLFdBQVdaLEVBQUVhLFVBQVUsRUFBRUQsV0FBV0UsUUFBUSxXQUFXO1FBQ3ZEQyxVQUFVZixFQUFFZSxRQUFRO1FBQ3BCQyxhQUFhaEIsRUFBRWdCLFdBQVc7UUFDMUJkO1FBQ0FlLFNBQVNqQixFQUFFa0IsV0FBVztRQUN0QlY7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYm9va3Njb3V0Ly4vc3JjL2xpYi9nb29nbGVCb29rcy50cz82ODk4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJvb2tNZXRhZGF0YSB9IGZyb20gJy4vdHlwZXMnXG5pbXBvcnQgeyBHT09HTEVfQk9PS1NfQVBJX0tFWSwgQU1BWk9OX0FGRklMSUFURV9UQUcgfSBmcm9tICcuL2NvbmZpZydcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaEdvb2dsZUJvb2tzQnlUaXRsZSh0aXRsZTogc3RyaW5nKTogUHJvbWlzZTxCb29rTWV0YWRhdGEgfCBudWxsPiB7XG4gIGNvbnN0IHEgPSBlbmNvZGVVUklDb21wb25lbnQoYGludGl0bGU6JHt0aXRsZX1gKVxuICBjb25zdCBrZXkgPSBHT09HTEVfQk9PS1NfQVBJX0tFWSA/IGAma2V5PSR7R09PR0xFX0JPT0tTX0FQSV9LRVl9YCA6ICcnXG4gIGNvbnN0IHVybCA9IGBodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9ib29rcy92MS92b2x1bWVzP3E9JHtxfSR7a2V5fSZtYXhSZXN1bHRzPTFgXG4gIGNvbnN0IHIgPSBhd2FpdCBmZXRjaCh1cmwpXG4gIGlmICghci5vaykgcmV0dXJuIG51bGxcbiAgY29uc3QgaiA9IGF3YWl0IHIuanNvbigpXG4gIGNvbnN0IGl0ZW0gPSBqLml0ZW1zPy5bMF1cbiAgaWYgKCFpdGVtKSByZXR1cm4gbnVsbFxuICBjb25zdCB2ID0gaXRlbS52b2x1bWVJbmZvIHx8IHt9XG4gIGNvbnN0IGlzYm4xMyA9ICh2LmluZHVzdHJ5SWRlbnRpZmllcnMgfHwgW10pLmZpbmQoKHg6IGFueSkgPT4geC50eXBlID09PSAnSVNCTl8xMycpPy5pZGVudGlmaWVyXG4gIGNvbnN0IGFtYXpvbkFmZmlsaWF0ZSA9IGlzYm4xMyAmJiBBTUFaT05fQUZGSUxJQVRFX1RBRyA/IGBodHRwczovL3d3dy5hbWF6b24uY29tL2RwLyR7aXNibjEzfS8/dGFnPSR7QU1BWk9OX0FGRklMSUFURV9UQUd9YCA6IHVuZGVmaW5lZFxuICByZXR1cm4ge1xuICAgIGlkOiBpdGVtLmlkLFxuICAgIHRpdGxlOiB2LnRpdGxlLFxuICAgIGF1dGhvcnM6IHYuYXV0aG9ycyB8fCBbXSxcbiAgICB0aHVtYm5haWw6IHYuaW1hZ2VMaW5rcz8udGh1bWJuYWlsPy5yZXBsYWNlKCdodHRwOi8vJywgJ2h0dHBzOi8vJyksXG4gICAgaW5mb0xpbms6IHYuaW5mb0xpbmssXG4gICAgcHJldmlld0xpbms6IHYucHJldmlld0xpbmssXG4gICAgaXNibjEzLFxuICAgIHN1bW1hcnk6IHYuZGVzY3JpcHRpb24sXG4gICAgYW1hem9uQWZmaWxpYXRlLFxuICB9XG59XG4iXSwibmFtZXMiOlsiR09PR0xFX0JPT0tTX0FQSV9LRVkiLCJBTUFaT05fQUZGSUxJQVRFX1RBRyIsInNlYXJjaEdvb2dsZUJvb2tzQnlUaXRsZSIsInRpdGxlIiwicSIsImVuY29kZVVSSUNvbXBvbmVudCIsImtleSIsInVybCIsInIiLCJmZXRjaCIsIm9rIiwiaiIsImpzb24iLCJpdGVtIiwiaXRlbXMiLCJ2Iiwidm9sdW1lSW5mbyIsImlzYm4xMyIsImluZHVzdHJ5SWRlbnRpZmllcnMiLCJmaW5kIiwieCIsInR5cGUiLCJpZGVudGlmaWVyIiwiYW1hem9uQWZmaWxpYXRlIiwidW5kZWZpbmVkIiwiaWQiLCJhdXRob3JzIiwidGh1bWJuYWlsIiwiaW1hZ2VMaW5rcyIsInJlcGxhY2UiLCJpbmZvTGluayIsInByZXZpZXdMaW5rIiwic3VtbWFyeSIsImRlc2NyaXB0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/googleBooks.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/openLibrary.ts":
/*!********************************!*\
  !*** ./src/lib/openLibrary.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   searchOpenLibraryByTitle: () => (/* binding */ searchOpenLibraryByTitle)\n/* harmony export */ });\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./config */ \"(rsc)/./src/lib/config.ts\");\n\nasync function searchOpenLibraryByTitle(title) {\n    const q = encodeURIComponent(title);\n    const url = `https://openlibrary.org/search.json?title=${q}&limit=1`;\n    const r = await fetch(url);\n    if (!r.ok) return null;\n    const j = await r.json();\n    const d = j.docs?.[0];\n    if (!d) return null;\n    const isbn13 = d.isbn?.find((x)=>x.length === 13);\n    const cover = d.cover_i ? `https://covers.openlibrary.org/b/id/${d.cover_i}-M.jpg` : undefined;\n    const amazonAffiliate = isbn13 && _config__WEBPACK_IMPORTED_MODULE_0__.AMAZON_AFFILIATE_TAG ? `https://www.amazon.com/dp/${isbn13}/?tag=${_config__WEBPACK_IMPORTED_MODULE_0__.AMAZON_AFFILIATE_TAG}` : undefined;\n    return {\n        id: `ol-${d.key}`,\n        title: d.title,\n        authors: d.author_name || [],\n        thumbnail: cover,\n        infoLink: d.key ? `https://openlibrary.org${d.key}` : undefined,\n        previewLink: undefined,\n        isbn13,\n        summary: d.first_sentence?.[0],\n        amazonAffiliate\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL29wZW5MaWJyYXJ5LnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQytDO0FBRXhDLGVBQWVDLHlCQUF5QkMsS0FBYTtJQUMxRCxNQUFNQyxJQUFJQyxtQkFBbUJGO0lBQzdCLE1BQU1HLE1BQU0sQ0FBQywwQ0FBMEMsRUFBRUYsRUFBRSxRQUFRLENBQUM7SUFDcEUsTUFBTUcsSUFBSSxNQUFNQyxNQUFNRjtJQUN0QixJQUFJLENBQUNDLEVBQUVFLEVBQUUsRUFBRSxPQUFPO0lBQ2xCLE1BQU1DLElBQUksTUFBTUgsRUFBRUksSUFBSTtJQUN0QixNQUFNQyxJQUFJRixFQUFFRyxJQUFJLEVBQUUsQ0FBQyxFQUFFO0lBQ3JCLElBQUksQ0FBQ0QsR0FBRyxPQUFPO0lBQ2YsTUFBTUUsU0FBU0YsRUFBRUcsSUFBSSxFQUFFQyxLQUFLLENBQUNDLElBQWNBLEVBQUVDLE1BQU0sS0FBSztJQUN4RCxNQUFNQyxRQUFRUCxFQUFFUSxPQUFPLEdBQUcsQ0FBQyxvQ0FBb0MsRUFBRVIsRUFBRVEsT0FBTyxDQUFDLE1BQU0sQ0FBQyxHQUFHQztJQUNyRixNQUFNQyxrQkFBa0JSLFVBQVViLHlEQUFvQkEsR0FBRyxDQUFDLDBCQUEwQixFQUFFYSxPQUFPLE1BQU0sRUFBRWIseURBQW9CQSxDQUFDLENBQUMsR0FBR29CO0lBQzlILE9BQU87UUFDTEUsSUFBSSxDQUFDLEdBQUcsRUFBRVgsRUFBRVksR0FBRyxDQUFDLENBQUM7UUFDakJyQixPQUFPUyxFQUFFVCxLQUFLO1FBQ2RzQixTQUFTYixFQUFFYyxXQUFXLElBQUksRUFBRTtRQUM1QkMsV0FBV1I7UUFDWFMsVUFBVWhCLEVBQUVZLEdBQUcsR0FBRyxDQUFDLHVCQUF1QixFQUFFWixFQUFFWSxHQUFHLENBQUMsQ0FBQyxHQUFHSDtRQUN0RFEsYUFBYVI7UUFDYlA7UUFDQWdCLFNBQVNsQixFQUFFbUIsY0FBYyxFQUFFLENBQUMsRUFBRTtRQUM5QlQ7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYm9va3Njb3V0Ly4vc3JjL2xpYi9vcGVuTGlicmFyeS50cz8wODQ0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJvb2tNZXRhZGF0YSB9IGZyb20gJy4vdHlwZXMnXG5pbXBvcnQgeyBBTUFaT05fQUZGSUxJQVRFX1RBRyB9IGZyb20gJy4vY29uZmlnJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VhcmNoT3BlbkxpYnJhcnlCeVRpdGxlKHRpdGxlOiBzdHJpbmcpOiBQcm9taXNlPEJvb2tNZXRhZGF0YSB8IG51bGw+IHtcbiAgY29uc3QgcSA9IGVuY29kZVVSSUNvbXBvbmVudCh0aXRsZSlcbiAgY29uc3QgdXJsID0gYGh0dHBzOi8vb3BlbmxpYnJhcnkub3JnL3NlYXJjaC5qc29uP3RpdGxlPSR7cX0mbGltaXQ9MWBcbiAgY29uc3QgciA9IGF3YWl0IGZldGNoKHVybClcbiAgaWYgKCFyLm9rKSByZXR1cm4gbnVsbFxuICBjb25zdCBqID0gYXdhaXQgci5qc29uKClcbiAgY29uc3QgZCA9IGouZG9jcz8uWzBdXG4gIGlmICghZCkgcmV0dXJuIG51bGxcbiAgY29uc3QgaXNibjEzID0gZC5pc2JuPy5maW5kKCh4OiBzdHJpbmcpID0+IHgubGVuZ3RoID09PSAxMylcbiAgY29uc3QgY292ZXIgPSBkLmNvdmVyX2kgPyBgaHR0cHM6Ly9jb3ZlcnMub3BlbmxpYnJhcnkub3JnL2IvaWQvJHtkLmNvdmVyX2l9LU0uanBnYCA6IHVuZGVmaW5lZFxuICBjb25zdCBhbWF6b25BZmZpbGlhdGUgPSBpc2JuMTMgJiYgQU1BWk9OX0FGRklMSUFURV9UQUcgPyBgaHR0cHM6Ly93d3cuYW1hem9uLmNvbS9kcC8ke2lzYm4xM30vP3RhZz0ke0FNQVpPTl9BRkZJTElBVEVfVEFHfWAgOiB1bmRlZmluZWRcbiAgcmV0dXJuIHtcbiAgICBpZDogYG9sLSR7ZC5rZXl9YCxcbiAgICB0aXRsZTogZC50aXRsZSxcbiAgICBhdXRob3JzOiBkLmF1dGhvcl9uYW1lIHx8IFtdLFxuICAgIHRodW1ibmFpbDogY292ZXIsXG4gICAgaW5mb0xpbms6IGQua2V5ID8gYGh0dHBzOi8vb3BlbmxpYnJhcnkub3JnJHtkLmtleX1gIDogdW5kZWZpbmVkLFxuICAgIHByZXZpZXdMaW5rOiB1bmRlZmluZWQsXG4gICAgaXNibjEzLFxuICAgIHN1bW1hcnk6IGQuZmlyc3Rfc2VudGVuY2U/LlswXSxcbiAgICBhbWF6b25BZmZpbGlhdGUsXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJBTUFaT05fQUZGSUxJQVRFX1RBRyIsInNlYXJjaE9wZW5MaWJyYXJ5QnlUaXRsZSIsInRpdGxlIiwicSIsImVuY29kZVVSSUNvbXBvbmVudCIsInVybCIsInIiLCJmZXRjaCIsIm9rIiwiaiIsImpzb24iLCJkIiwiZG9jcyIsImlzYm4xMyIsImlzYm4iLCJmaW5kIiwieCIsImxlbmd0aCIsImNvdmVyIiwiY292ZXJfaSIsInVuZGVmaW5lZCIsImFtYXpvbkFmZmlsaWF0ZSIsImlkIiwia2V5IiwiYXV0aG9ycyIsImF1dGhvcl9uYW1lIiwidGh1bWJuYWlsIiwiaW5mb0xpbmsiLCJwcmV2aWV3TGluayIsInN1bW1hcnkiLCJmaXJzdF9zZW50ZW5jZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/openLibrary.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@google"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmetadata%2Froute&page=%2Fapi%2Fmetadata%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmetadata%2Froute.ts&appDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();