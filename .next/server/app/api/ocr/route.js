"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/ocr/route";
exports.ids = ["app/api/ocr/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Focr%2Froute&page=%2Fapi%2Focr%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Focr%2Froute.ts&appDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Focr%2Froute&page=%2Fapi%2Focr%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Focr%2Froute.ts&appDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_rishabh_Documents_personal_bookscout_src_app_api_ocr_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/ocr/route.ts */ \"(rsc)/./src/app/api/ocr/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/ocr/route\",\n        pathname: \"/api/ocr\",\n        filename: \"route\",\n        bundlePath: \"app/api/ocr/route\"\n    },\n    resolvedPagePath: \"/Users/rishabh/Documents/personal/bookscout/src/app/api/ocr/route.ts\",\n    nextConfigOutput,\n    userland: _Users_rishabh_Documents_personal_bookscout_src_app_api_ocr_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/ocr/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZvY3IlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRm9jciUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRm9jciUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnJpc2hhYmglMkZEb2N1bWVudHMlMkZwZXJzb25hbCUyRmJvb2tzY291dCUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZyaXNoYWJoJTJGRG9jdW1lbnRzJTJGcGVyc29uYWwlMkZib29rc2NvdXQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ29CO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYm9va3Njb3V0Lz9kYWE4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9yaXNoYWJoL0RvY3VtZW50cy9wZXJzb25hbC9ib29rc2NvdXQvc3JjL2FwcC9hcGkvb2NyL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9vY3Ivcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9vY3JcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL29jci9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9yaXNoYWJoL0RvY3VtZW50cy9wZXJzb25hbC9ib29rc2NvdXQvc3JjL2FwcC9hcGkvb2NyL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9vY3Ivcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Focr%2Froute&page=%2Fapi%2Focr%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Focr%2Froute.ts&appDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/ocr/route.ts":
/*!**********************************!*\
  !*** ./src/app/api/ocr/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_gemini__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/gemini */ \"(rsc)/./src/lib/gemini.ts\");\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./src/lib/config.ts\");\n\n\n\nconst RATE_LIMIT_WINDOW_MS = 60000;\nconst RATE_LIMIT_MAX = 10;\nconst requests = new Map();\nfunction rateLimit(ip) {\n    const now = Date.now();\n    const arr = (requests.get(ip) || []).filter((t)=>now - t < RATE_LIMIT_WINDOW_MS);\n    arr.push(now);\n    requests.set(ip, arr);\n    return arr.length <= RATE_LIMIT_MAX;\n}\nasync function POST(req) {\n    // Rate limit\n    const ip = (req.headers.get(\"x-forwarded-for\") || req.headers.get(\"x-real-ip\") || \"local\").split(\",\")[0].trim();\n    if (!rateLimit(ip)) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        error: \"Rate limit exceeded\"\n    }, {\n        status: 429\n    });\n    const ct = req.headers.get(\"content-type\") || \"\";\n    if (!ct.includes(\"multipart/form-data\")) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Expected multipart/form-data with field \"image\"'\n        }, {\n            status: 400\n        });\n    }\n    if (!_lib_config__WEBPACK_IMPORTED_MODULE_2__.GEMINI_API_KEY) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"GEMINI_API_KEY not configured\"\n        }, {\n            status: 500\n        });\n    }\n    try {\n        const form = await req.formData();\n        const file = form.get(\"image\");\n        if (!file) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Missing image\"\n        }, {\n            status: 400\n        });\n        const bytes = new Uint8Array(await file.arrayBuffer());\n        const { titles, authors } = await (0,_lib_gemini__WEBPACK_IMPORTED_MODULE_1__.ocrFromImage)(bytes, file.type || \"image/jpeg\");\n        // Post-cleaning\n        const cleanedTitles = Array.from(new Set(titles.map((t)=>t.replace(/\\s+/g, \" \").trim()))).slice(0, 50);\n        const cleanedAuthors = Array.from(new Set(authors.map((a)=>a.replace(/\\s+/g, \" \").trim()))).slice(0, 50);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            titles: cleanedTitles,\n            authors: cleanedAuthors\n        });\n    } catch (e) {\n        console.error(\"OCR error\", e);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"OCR failed. Try again later.\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9vY3Ivcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUEwQztBQUNDO0FBQ0U7QUFFN0MsTUFBTUcsdUJBQXVCO0FBQzdCLE1BQU1DLGlCQUFpQjtBQUN2QixNQUFNQyxXQUFXLElBQUlDO0FBRXJCLFNBQVNDLFVBQVVDLEVBQVU7SUFDM0IsTUFBTUMsTUFBTUMsS0FBS0QsR0FBRztJQUNwQixNQUFNRSxNQUFNLENBQUNOLFNBQVNPLEdBQUcsQ0FBQ0osT0FBTyxFQUFFLEVBQUVLLE1BQU0sQ0FBQ0MsQ0FBQUEsSUFBS0wsTUFBTUssSUFBSVg7SUFDM0RRLElBQUlJLElBQUksQ0FBQ047SUFDVEosU0FBU1csR0FBRyxDQUFDUixJQUFJRztJQUNqQixPQUFPQSxJQUFJTSxNQUFNLElBQUliO0FBQ3ZCO0FBRU8sZUFBZWMsS0FBS0MsR0FBWTtJQUNyQyxhQUFhO0lBQ2IsTUFBTVgsS0FBSyxDQUFDVyxJQUFJQyxPQUFPLENBQUNSLEdBQUcsQ0FBQyxzQkFBc0JPLElBQUlDLE9BQU8sQ0FBQ1IsR0FBRyxDQUFDLGdCQUFnQixPQUFNLEVBQUdTLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDQyxJQUFJO0lBQzdHLElBQUksQ0FBQ2YsVUFBVUMsS0FBSyxPQUFPUixxREFBWUEsQ0FBQ3VCLElBQUksQ0FBQztRQUFFQyxPQUFPO0lBQXNCLEdBQUc7UUFBRUMsUUFBUTtJQUFJO0lBRTdGLE1BQU1DLEtBQUtQLElBQUlDLE9BQU8sQ0FBQ1IsR0FBRyxDQUFDLG1CQUFtQjtJQUM5QyxJQUFJLENBQUNjLEdBQUdDLFFBQVEsQ0FBQyx3QkFBd0I7UUFDdkMsT0FBTzNCLHFEQUFZQSxDQUFDdUIsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBa0QsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDdkc7SUFDQSxJQUFJLENBQUN2Qix1REFBY0EsRUFBRTtRQUNuQixPQUFPRixxREFBWUEsQ0FBQ3VCLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQWdDLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ3JGO0lBRUEsSUFBSTtRQUNGLE1BQU1HLE9BQU8sTUFBTVQsSUFBSVUsUUFBUTtRQUMvQixNQUFNQyxPQUFPRixLQUFLaEIsR0FBRyxDQUFDO1FBQ3RCLElBQUksQ0FBQ2tCLE1BQU0sT0FBTzlCLHFEQUFZQSxDQUFDdUIsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBZ0IsR0FBRztZQUFFQyxRQUFRO1FBQUk7UUFDOUUsTUFBTU0sUUFBUSxJQUFJQyxXQUFXLE1BQU1GLEtBQUtHLFdBQVc7UUFFbkQsTUFBTSxFQUFFQyxNQUFNLEVBQUVDLE9BQU8sRUFBRSxHQUFHLE1BQU1sQyx5REFBWUEsQ0FBQzhCLE9BQU9ELEtBQUtNLElBQUksSUFBSTtRQUVuRSxnQkFBZ0I7UUFDaEIsTUFBTUMsZ0JBQWdCQyxNQUFNQyxJQUFJLENBQUMsSUFBSUMsSUFBSU4sT0FBT08sR0FBRyxDQUFDM0IsQ0FBQUEsSUFBS0EsRUFBRTRCLE9BQU8sQ0FBQyxRQUFRLEtBQUtwQixJQUFJLE1BQU1xQixLQUFLLENBQUMsR0FBRztRQUNuRyxNQUFNQyxpQkFBaUJOLE1BQU1DLElBQUksQ0FBQyxJQUFJQyxJQUFJTCxRQUFRTSxHQUFHLENBQUNJLENBQUFBLElBQUtBLEVBQUVILE9BQU8sQ0FBQyxRQUFRLEtBQUtwQixJQUFJLE1BQU1xQixLQUFLLENBQUMsR0FBRztRQUVyRyxPQUFPM0MscURBQVlBLENBQUN1QixJQUFJLENBQUM7WUFBRVcsUUFBUUc7WUFBZUYsU0FBU1M7UUFBZTtJQUM1RSxFQUFFLE9BQU9FLEdBQVE7UUFDZkMsUUFBUXZCLEtBQUssQ0FBQyxhQUFhc0I7UUFDM0IsT0FBTzlDLHFEQUFZQSxDQUFDdUIsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBK0IsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDcEY7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Jvb2tzY291dC8uL3NyYy9hcHAvYXBpL29jci9yb3V0ZS50cz9lMjcwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgb2NyRnJvbUltYWdlIH0gZnJvbSAnQC9saWIvZ2VtaW5pJ1xuaW1wb3J0IHsgR0VNSU5JX0FQSV9LRVkgfSBmcm9tICdAL2xpYi9jb25maWcnXG5cbmNvbnN0IFJBVEVfTElNSVRfV0lORE9XX01TID0gNjBfMDAwXG5jb25zdCBSQVRFX0xJTUlUX01BWCA9IDEwXG5jb25zdCByZXF1ZXN0cyA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXJbXT4oKVxuXG5mdW5jdGlvbiByYXRlTGltaXQoaXA6IHN0cmluZykge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpXG4gIGNvbnN0IGFyciA9IChyZXF1ZXN0cy5nZXQoaXApIHx8IFtdKS5maWx0ZXIodCA9PiBub3cgLSB0IDwgUkFURV9MSU1JVF9XSU5ET1dfTVMpXG4gIGFyci5wdXNoKG5vdylcbiAgcmVxdWVzdHMuc2V0KGlwLCBhcnIpXG4gIHJldHVybiBhcnIubGVuZ3RoIDw9IFJBVEVfTElNSVRfTUFYXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogUmVxdWVzdCkge1xuICAvLyBSYXRlIGxpbWl0XG4gIGNvbnN0IGlwID0gKHJlcS5oZWFkZXJzLmdldCgneC1mb3J3YXJkZWQtZm9yJykgfHwgcmVxLmhlYWRlcnMuZ2V0KCd4LXJlYWwtaXAnKSB8fCAnbG9jYWwnKS5zcGxpdCgnLCcpWzBdLnRyaW0oKVxuICBpZiAoIXJhdGVMaW1pdChpcCkpIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnUmF0ZSBsaW1pdCBleGNlZWRlZCcgfSwgeyBzdGF0dXM6IDQyOSB9KVxuXG4gIGNvbnN0IGN0ID0gcmVxLmhlYWRlcnMuZ2V0KCdjb250ZW50LXR5cGUnKSB8fCAnJ1xuICBpZiAoIWN0LmluY2x1ZGVzKCdtdWx0aXBhcnQvZm9ybS1kYXRhJykpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0V4cGVjdGVkIG11bHRpcGFydC9mb3JtLWRhdGEgd2l0aCBmaWVsZCBcImltYWdlXCInIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgfVxuICBpZiAoIUdFTUlOSV9BUElfS0VZKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdHRU1JTklfQVBJX0tFWSBub3QgY29uZmlndXJlZCcgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBmb3JtID0gYXdhaXQgcmVxLmZvcm1EYXRhKClcbiAgICBjb25zdCBmaWxlID0gZm9ybS5nZXQoJ2ltYWdlJykgYXMgRmlsZSB8IG51bGxcbiAgICBpZiAoIWZpbGUpIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTWlzc2luZyBpbWFnZScgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXdhaXQgZmlsZS5hcnJheUJ1ZmZlcigpKVxuXG4gICAgY29uc3QgeyB0aXRsZXMsIGF1dGhvcnMgfSA9IGF3YWl0IG9jckZyb21JbWFnZShieXRlcywgZmlsZS50eXBlIHx8ICdpbWFnZS9qcGVnJylcblxuICAgIC8vIFBvc3QtY2xlYW5pbmdcbiAgICBjb25zdCBjbGVhbmVkVGl0bGVzID0gQXJyYXkuZnJvbShuZXcgU2V0KHRpdGxlcy5tYXAodCA9PiB0LnJlcGxhY2UoL1xccysvZywgJyAnKS50cmltKCkpKSkuc2xpY2UoMCwgNTApXG4gICAgY29uc3QgY2xlYW5lZEF1dGhvcnMgPSBBcnJheS5mcm9tKG5ldyBTZXQoYXV0aG9ycy5tYXAoYSA9PiBhLnJlcGxhY2UoL1xccysvZywgJyAnKS50cmltKCkpKSkuc2xpY2UoMCwgNTApXG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyB0aXRsZXM6IGNsZWFuZWRUaXRsZXMsIGF1dGhvcnM6IGNsZWFuZWRBdXRob3JzIH0pXG4gIH0gY2F0Y2ggKGU6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ09DUiBlcnJvcicsIGUpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdPQ1IgZmFpbGVkLiBUcnkgYWdhaW4gbGF0ZXIuJyB9LCB7IHN0YXR1czogNTAwIH0pXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJvY3JGcm9tSW1hZ2UiLCJHRU1JTklfQVBJX0tFWSIsIlJBVEVfTElNSVRfV0lORE9XX01TIiwiUkFURV9MSU1JVF9NQVgiLCJyZXF1ZXN0cyIsIk1hcCIsInJhdGVMaW1pdCIsImlwIiwibm93IiwiRGF0ZSIsImFyciIsImdldCIsImZpbHRlciIsInQiLCJwdXNoIiwic2V0IiwibGVuZ3RoIiwiUE9TVCIsInJlcSIsImhlYWRlcnMiLCJzcGxpdCIsInRyaW0iLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJjdCIsImluY2x1ZGVzIiwiZm9ybSIsImZvcm1EYXRhIiwiZmlsZSIsImJ5dGVzIiwiVWludDhBcnJheSIsImFycmF5QnVmZmVyIiwidGl0bGVzIiwiYXV0aG9ycyIsInR5cGUiLCJjbGVhbmVkVGl0bGVzIiwiQXJyYXkiLCJmcm9tIiwiU2V0IiwibWFwIiwicmVwbGFjZSIsInNsaWNlIiwiY2xlYW5lZEF1dGhvcnMiLCJhIiwiZSIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/ocr/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/config.ts":
/*!***************************!*\
  !*** ./src/lib/config.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AMAZON_AFFILIATE_TAG: () => (/* binding */ AMAZON_AFFILIATE_TAG),\n/* harmony export */   GEMINI_API_KEY: () => (/* binding */ GEMINI_API_KEY),\n/* harmony export */   GOOGLE_BOOKS_API_KEY: () => (/* binding */ GOOGLE_BOOKS_API_KEY)\n/* harmony export */ });\nconst GEMINI_API_KEY = process.env.GEMINI_API_KEY || \"\";\nconst GOOGLE_BOOKS_API_KEY = process.env.GOOGLE_BOOKS_API_KEY || \"\";\nconst AMAZON_AFFILIATE_TAG = process.env.AMAZON_AFFILIATE_TAG || \"\";\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NvbmZpZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBTyxNQUFNQSxpQkFBaUJDLFFBQVFDLEdBQUcsQ0FBQ0YsY0FBYyxJQUFJLEdBQUU7QUFDdkQsTUFBTUcsdUJBQXVCRixRQUFRQyxHQUFHLENBQUNDLG9CQUFvQixJQUFJLEdBQUU7QUFDbkUsTUFBTUMsdUJBQXVCSCxRQUFRQyxHQUFHLENBQUNFLG9CQUFvQixJQUFJLEdBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ib29rc2NvdXQvLi9zcmMvbGliL2NvbmZpZy50cz9hM2VmIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBHRU1JTklfQVBJX0tFWSA9IHByb2Nlc3MuZW52LkdFTUlOSV9BUElfS0VZIHx8ICcnXG5leHBvcnQgY29uc3QgR09PR0xFX0JPT0tTX0FQSV9LRVkgPSBwcm9jZXNzLmVudi5HT09HTEVfQk9PS1NfQVBJX0tFWSB8fCAnJ1xuZXhwb3J0IGNvbnN0IEFNQVpPTl9BRkZJTElBVEVfVEFHID0gcHJvY2Vzcy5lbnYuQU1BWk9OX0FGRklMSUFURV9UQUcgfHwgJydcbiJdLCJuYW1lcyI6WyJHRU1JTklfQVBJX0tFWSIsInByb2Nlc3MiLCJlbnYiLCJHT09HTEVfQk9PS1NfQVBJX0tFWSIsIkFNQVpPTl9BRkZJTElBVEVfVEFHIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/config.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/gemini.ts":
/*!***************************!*\
  !*** ./src/lib/gemini.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   genAI: () => (/* binding */ genAI),\n/* harmony export */   ocrFromImage: () => (/* binding */ ocrFromImage),\n/* harmony export */   summarizeAndReason: () => (/* binding */ summarizeAndReason),\n/* harmony export */   textModel: () => (/* binding */ textModel)\n/* harmony export */ });\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./config */ \"(rsc)/./src/lib/config.ts\");\n\n\nif (!_config__WEBPACK_IMPORTED_MODULE_1__.GEMINI_API_KEY) {\n// Let routes handle the error gracefully; no throw here to allow app to boot\n}\nconst genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__.GoogleGenerativeAI(_config__WEBPACK_IMPORTED_MODULE_1__.GEMINI_API_KEY);\nfunction textModel() {\n    return genAI.getGenerativeModel({\n        model: \"gemini-1.5-flash\"\n    });\n}\nfunction stripCodeFences(s) {\n    // Remove ```json ... ``` or ``` ... ``` fences\n    const fenced = s.match(/```(?:json)?\\n([\\s\\S]*?)```/i);\n    if (fenced && fenced[1]) return fenced[1].trim();\n    return s.trim();\n}\nfunction extractJSONObject(text) {\n    const cleaned = stripCodeFences(text);\n    // Try to find the first '{' and the matching last '}'\n    const first = cleaned.indexOf(\"{\");\n    const last = cleaned.lastIndexOf(\"}\");\n    if (first !== -1 && last !== -1 && last > first) {\n        const candidate = cleaned.slice(first, last + 1);\n        try {\n            return JSON.parse(candidate);\n        } catch  {}\n    }\n    // Fallback: try to eval a safer JSON by removing trailing commas\n    try {\n        const relaxed = cleaned.replace(/,\\s*([}\\]])/g, \"$1\") // remove trailing commas\n        ;\n        const f = relaxed.indexOf(\"{\");\n        const l = relaxed.lastIndexOf(\"}\");\n        if (f !== -1 && l !== -1 && l > f) {\n            return JSON.parse(relaxed.slice(f, l + 1));\n        }\n    } catch  {}\n    throw new Error(\"Failed to parse JSON from model output\");\n}\nasync function ocrFromImage(bytes, mimeType) {\n    const model = textModel();\n    const prompt = `You are an OCR assistant for bookshelf photos. Extract plausible book titles and optional authors.\n  Return only JSON with shape: {\"titles\": string[], \"authors\": string[]}. Titles should be deduplicated, trimmed.`;\n    const res = await model.generateContent([\n        {\n            text: prompt\n        },\n        {\n            inlineData: {\n                data: Buffer.from(bytes).toString(\"base64\"),\n                mimeType\n            }\n        }\n    ]);\n    const out = res.response.text();\n    try {\n        const json = extractJSONObject(out);\n        return {\n            titles: Array.from(new Set((json.titles || []).map((s)=>s.trim()))),\n            authors: Array.from(new Set((json.authors || []).map((s)=>s.trim())))\n        };\n    } catch  {\n        // naive fallback: extract Capitalized phrases\n        const text = out.replace(/\\n/g, \" \");\n        const matches = text.match(/([A-Z][A-Za-z0-9'’:&-]+(?:\\s+[A-Z][A-Za-z0-9'’:&-]+){0,6})/g) || [];\n        const titles = Array.from(new Set(matches.map((s)=>s.trim()).filter((s)=>s.split(\" \").length >= 2))).slice(0, 50);\n        return {\n            titles,\n            authors: []\n        };\n    }\n}\nasync function summarizeAndReason(payload) {\n    const model = textModel();\n    const prompt = `Given extracted shelf titles, user preferences, and matched book metadata, produce:\n- summary: 3-6 bullet points concise.\n- reasons: a mapping from book id to a one-sentence reason (<=25 words) why it matches.\nKeep it helpful and specific. Return only JSON {\"summary\": string, \"reasons\": Record<string,string>}.`;\n    const res = await model.generateContent([\n        {\n            text: prompt + \"\\n\\nDATA:\\n\" + JSON.stringify(payload)\n        }\n    ]);\n    const out = res.response.text();\n    try {\n        return extractJSONObject(out);\n    } catch  {\n        return {\n            summary: \"AI unavailable. Showing matched titles from metadata only.\",\n            reasons: {}\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUV5QyxLQUFLLENBQUMsS0FBS0MsTUFBTSxJQUFFLEtBQUs5QixLQUFLLENBQUMsR0FBRTtRQUN2RyxPQUFPO1lBQUVzQjtZQUFRSSxTQUFTLEVBQUU7UUFBYTtJQUMzQztBQUNGO0FBRU8sZUFBZUssbUJBQW1CQyxPQUFZO0lBQ25ELE1BQU05QyxRQUFRRjtJQUNkLE1BQU0yQixTQUFTLENBQUM7OztxR0FHbUYsQ0FBQztJQUNwRyxNQUFNQyxNQUFNLE1BQU0xQixNQUFNMkIsZUFBZSxDQUFDO1FBQUM7WUFBRXBCLE1BQU1rQixTQUFTLGdCQUFnQlYsS0FBS2dDLFNBQVMsQ0FBQ0Q7UUFBUztLQUFFO0lBQ3BHLE1BQU1iLE1BQU1QLElBQUlRLFFBQVEsQ0FBQzNCLElBQUk7SUFDN0IsSUFBSTtRQUNGLE9BQU9ELGtCQUFrQjJCO0lBQzNCLEVBQUUsT0FBTTtRQUNOLE9BQU87WUFBRWUsU0FBUztZQUE4REMsU0FBUyxDQUFDO1FBQUU7SUFDOUY7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Jvb2tzY291dC8uL3NyYy9saWIvZ2VtaW5pLnRzPzk5NGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR29vZ2xlR2VuZXJhdGl2ZUFJIH0gZnJvbSAnQGdvb2dsZS9nZW5lcmF0aXZlLWFpJ1xuaW1wb3J0IHsgR0VNSU5JX0FQSV9LRVkgfSBmcm9tICcuL2NvbmZpZydcblxuaWYgKCFHRU1JTklfQVBJX0tFWSkge1xuICAvLyBMZXQgcm91dGVzIGhhbmRsZSB0aGUgZXJyb3IgZ3JhY2VmdWxseTsgbm8gdGhyb3cgaGVyZSB0byBhbGxvdyBhcHAgdG8gYm9vdFxufVxuXG5leHBvcnQgY29uc3QgZ2VuQUkgPSBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJKEdFTUlOSV9BUElfS0VZKVxuXG5leHBvcnQgZnVuY3Rpb24gdGV4dE1vZGVsKCkge1xuICByZXR1cm4gZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgbW9kZWw6ICdnZW1pbmktMS41LWZsYXNoJyB9KVxufVxuXG5mdW5jdGlvbiBzdHJpcENvZGVGZW5jZXMoczogc3RyaW5nKSB7XG4gIC8vIFJlbW92ZSBgYGBqc29uIC4uLiBgYGAgb3IgYGBgIC4uLiBgYGAgZmVuY2VzXG4gIGNvbnN0IGZlbmNlZCA9IHMubWF0Y2goL2BgYCg/Ompzb24pP1xcbihbXFxzXFxTXSo/KWBgYC9pKVxuICBpZiAoZmVuY2VkICYmIGZlbmNlZFsxXSkgcmV0dXJuIGZlbmNlZFsxXS50cmltKClcbiAgcmV0dXJuIHMudHJpbSgpXG59XG5cbmZ1bmN0aW9uIGV4dHJhY3RKU09OT2JqZWN0KHRleHQ6IHN0cmluZyk6IGFueSB7XG4gIGNvbnN0IGNsZWFuZWQgPSBzdHJpcENvZGVGZW5jZXModGV4dClcbiAgLy8gVHJ5IHRvIGZpbmQgdGhlIGZpcnN0ICd7JyBhbmQgdGhlIG1hdGNoaW5nIGxhc3QgJ30nXG4gIGNvbnN0IGZpcnN0ID0gY2xlYW5lZC5pbmRleE9mKCd7JylcbiAgY29uc3QgbGFzdCA9IGNsZWFuZWQubGFzdEluZGV4T2YoJ30nKVxuICBpZiAoZmlyc3QgIT09IC0xICYmIGxhc3QgIT09IC0xICYmIGxhc3QgPiBmaXJzdCkge1xuICAgIGNvbnN0IGNhbmRpZGF0ZSA9IGNsZWFuZWQuc2xpY2UoZmlyc3QsIGxhc3QgKyAxKVxuICAgIHRyeSB7IHJldHVybiBKU09OLnBhcnNlKGNhbmRpZGF0ZSkgfSBjYXRjaCB7fVxuICB9XG4gIC8vIEZhbGxiYWNrOiB0cnkgdG8gZXZhbCBhIHNhZmVyIEpTT04gYnkgcmVtb3ZpbmcgdHJhaWxpbmcgY29tbWFzXG4gIHRyeSB7XG4gICAgY29uc3QgcmVsYXhlZCA9IGNsZWFuZWRcbiAgICAgIC5yZXBsYWNlKC8sXFxzKihbfVxcXV0pL2csICckMScpIC8vIHJlbW92ZSB0cmFpbGluZyBjb21tYXNcbiAgICBjb25zdCBmID0gcmVsYXhlZC5pbmRleE9mKCd7JylcbiAgICBjb25zdCBsID0gcmVsYXhlZC5sYXN0SW5kZXhPZignfScpXG4gICAgaWYgKGYgIT09IC0xICYmIGwgIT09IC0xICYmIGwgPiBmKSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShyZWxheGVkLnNsaWNlKGYsIGwgKyAxKSlcbiAgICB9XG4gIH0gY2F0Y2gge31cbiAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gcGFyc2UgSlNPTiBmcm9tIG1vZGVsIG91dHB1dCcpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvY3JGcm9tSW1hZ2UoYnl0ZXM6IFVpbnQ4QXJyYXksIG1pbWVUeXBlOiBzdHJpbmcpIHtcbiAgY29uc3QgbW9kZWwgPSB0ZXh0TW9kZWwoKVxuICBjb25zdCBwcm9tcHQgPSBgWW91IGFyZSBhbiBPQ1IgYXNzaXN0YW50IGZvciBib29rc2hlbGYgcGhvdG9zLiBFeHRyYWN0IHBsYXVzaWJsZSBib29rIHRpdGxlcyBhbmQgb3B0aW9uYWwgYXV0aG9ycy5cbiAgUmV0dXJuIG9ubHkgSlNPTiB3aXRoIHNoYXBlOiB7XCJ0aXRsZXNcIjogc3RyaW5nW10sIFwiYXV0aG9yc1wiOiBzdHJpbmdbXX0uIFRpdGxlcyBzaG91bGQgYmUgZGVkdXBsaWNhdGVkLCB0cmltbWVkLmBcbiAgY29uc3QgcmVzID0gYXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KFtcbiAgICB7IHRleHQ6IHByb21wdCB9LFxuICAgIHsgaW5saW5lRGF0YTogeyBkYXRhOiBCdWZmZXIuZnJvbShieXRlcykudG9TdHJpbmcoJ2Jhc2U2NCcpLCBtaW1lVHlwZSB9IGFzIGFueSB9LFxuICBdKVxuICBjb25zdCBvdXQgPSByZXMucmVzcG9uc2UudGV4dCgpXG4gIHRyeSB7XG4gICAgY29uc3QganNvbiA9IGV4dHJhY3RKU09OT2JqZWN0KG91dClcbiAgICByZXR1cm4geyB0aXRsZXM6IEFycmF5LmZyb20obmV3IFNldCgoanNvbi50aXRsZXN8fFtdKS5tYXAoKHM6c3RyaW5nKT0+cy50cmltKCkpKSksIGF1dGhvcnM6IEFycmF5LmZyb20obmV3IFNldCgoanNvbi5hdXRob3JzfHxbXSkubWFwKChzOnN0cmluZyk9PnMudHJpbSgpKSkpIH1cbiAgfSBjYXRjaCB7XG4gICAgLy8gbmFpdmUgZmFsbGJhY2s6IGV4dHJhY3QgQ2FwaXRhbGl6ZWQgcGhyYXNlc1xuICAgIGNvbnN0IHRleHQgPSBvdXQucmVwbGFjZSgvXFxuL2csICcgJylcbiAgICBjb25zdCBtYXRjaGVzID0gdGV4dC5tYXRjaCgvKFtBLVpdW0EtWmEtejAtOSfigJk6Ji1dKyg/OlxccytbQS1aXVtBLVphLXowLTkn4oCZOiYtXSspezAsNn0pL2cpIHx8IFtdXG4gICAgY29uc3QgdGl0bGVzID0gQXJyYXkuZnJvbShuZXcgU2V0KG1hdGNoZXMubWFwKHM9PnMudHJpbSgpKS5maWx0ZXIocz0+cy5zcGxpdCgnICcpLmxlbmd0aD49MikpKS5zbGljZSgwLDUwKVxuICAgIHJldHVybiB7IHRpdGxlcywgYXV0aG9yczogW10gYXMgc3RyaW5nW10gfVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdW1tYXJpemVBbmRSZWFzb24ocGF5bG9hZDogYW55KSB7XG4gIGNvbnN0IG1vZGVsID0gdGV4dE1vZGVsKClcbiAgY29uc3QgcHJvbXB0ID0gYEdpdmVuIGV4dHJhY3RlZCBzaGVsZiB0aXRsZXMsIHVzZXIgcHJlZmVyZW5jZXMsIGFuZCBtYXRjaGVkIGJvb2sgbWV0YWRhdGEsIHByb2R1Y2U6XG4tIHN1bW1hcnk6IDMtNiBidWxsZXQgcG9pbnRzIGNvbmNpc2UuXG4tIHJlYXNvbnM6IGEgbWFwcGluZyBmcm9tIGJvb2sgaWQgdG8gYSBvbmUtc2VudGVuY2UgcmVhc29uICg8PTI1IHdvcmRzKSB3aHkgaXQgbWF0Y2hlcy5cbktlZXAgaXQgaGVscGZ1bCBhbmQgc3BlY2lmaWMuIFJldHVybiBvbmx5IEpTT04ge1wic3VtbWFyeVwiOiBzdHJpbmcsIFwicmVhc29uc1wiOiBSZWNvcmQ8c3RyaW5nLHN0cmluZz59LmBcbiAgY29uc3QgcmVzID0gYXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KFt7IHRleHQ6IHByb21wdCArIFwiXFxuXFxuREFUQTpcXG5cIiArIEpTT04uc3RyaW5naWZ5KHBheWxvYWQpIH1dKVxuICBjb25zdCBvdXQgPSByZXMucmVzcG9uc2UudGV4dCgpXG4gIHRyeSB7XG4gICAgcmV0dXJuIGV4dHJhY3RKU09OT2JqZWN0KG91dClcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIHsgc3VtbWFyeTogJ0FJIHVuYXZhaWxhYmxlLiBTaG93aW5nIG1hdGNoZWQgdGl0bGVzIGZyb20gbWV0YWRhdGEgb25seS4nLCByZWFzb25zOiB7fSB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJHb29nbGVHZW5lcmF0aXZlQUkiLCJHRU1JTklfQVBJX0tFWSIsImdlbkFJIiwidGV4dE1vZGVsIiwiZ2V0R2VuZXJhdGl2ZU1vZGVsIiwibW9kZWwiLCJzdHJpcENvZGVGZW5jZXMiLCJzIiwiZmVuY2VkIiwibWF0Y2giLCJ0cmltIiwiZXh0cmFjdEpTT05PYmplY3QiLCJ0ZXh0IiwiY2xlYW5lZCIsImZpcnN0IiwiaW5kZXhPZiIsImxhc3QiLCJsYXN0SW5kZXhPZiIsImNhbmRpZGF0ZSIsInNsaWNlIiwiSlNPTiIsInBhcnNlIiwicmVsYXhlZCIsInJlcGxhY2UiLCJmIiwibCIsIkVycm9yIiwib2NyRnJvbUltYWdlIiwiYnl0ZXMiLCJtaW1lVHlwZSIsInByb21wdCIsInJlcyIsImdlbmVyYXRlQ29udGVudCIsImlubGluZURhdGEiLCJkYXRhIiwiQnVmZmVyIiwiZnJvbSIsInRvU3RyaW5nIiwib3V0IiwicmVzcG9uc2UiLCJqc29uIiwidGl0bGVzIiwiQXJyYXkiLCJTZXQiLCJtYXAiLCJhdXRob3JzIiwibWF0Y2hlcyIsImZpbHRlciIsInNwbGl0IiwibGVuZ3RoIiwic3VtbWFyaXplQW5kUmVhc29uIiwicGF5bG9hZCIsInN0cmluZ2lmeSIsInN1bW1hcnkiLCJyZWFzb25zIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/gemini.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@google"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Focr%2Froute&page=%2Fapi%2Focr%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Focr%2Froute.ts&appDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frishabh%2FDocuments%2Fpersonal%2Fbookscout&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();